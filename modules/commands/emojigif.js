const axios = require('axios');
const fs = require('fs');
const path = require('path');

module.exports.config = {
    name: "emojigif",
    version: "1.0.1",
    hasPermssion: 0,
    credits: "Modified by dgk",
    description: "Convert an emoji to its corresponding animated GIF",
    commandCategory: "Ng∆∞·ªùi d√πng",
    usages: "[emoji]",
    usePrefix: true,
    cooldowns: 4,
    dependencies: {}
};

module.exports.run = async function ({ api, event, args }) {
    const { threadID, messageID } = event;

    
    if (args.length < 1) {
        return api.sendMessage("‚ö†Ô∏è Vui l√≤ng nh·∫≠p m·ªôt emoji ƒë·ªÉ chuy·ªÉn th√†nh GIF: [emoji]", threadID, messageID);
    }
    const emojiInput = args[0];

    
    const availableEmojis =
        "üòÄüòÉüòÑüòÅüòÜüòÖüòÇü§£üò≠üòâüòóüòôüòöüòòü•∞üòçü§©ü•≥üôÉüôÇü•≤ü•πüòä‚ò∫Ô∏èüòåüòèü§§üòãüòõüòùüòúü§™ü•¥üòîü•∫üò¨üòëüòêüò∂ü§êü§îü§´ü´¢ü§≠ü•±ü§óüò±ü§®üßêüòíüôÑüòÆ‚Äçüí®üò§üò†üò°ü§¨üòûüòìüòüüò•üò¢‚òπÔ∏èüôÅüò∞üò®üòßüò¶üòÆüòØüò≤üò≥ü§Øüòñüò£üò©üò´üòµü•∂ü•µü§¢ü§Æüò¥üò™ü§ßü§íü§ïüò∑ü§•üòáü§†ü§ëü§ìüòéü•∏ü§°üòàüëøüöÄü¶ñüêòü¶Öüêµüêíü¶çüê∂üêïüê©üê∫ü¶äü¶ùüê±üêàü¶ÅüêØüêÖüêÜüê¥üêéü¶Ñü¶ìü¶åüêÆüêÇüêÉüêÑüê∑üêñüêóüêΩüêèüêëüêêüê™üê´ü¶ôü¶íüêòüêπü¶èüêÄü¶õüêÅüê≠üê∞üêáüêøÔ∏èü¶îü¶áüêªüê®üêºüêìü¶òüêîü¶Éü¶°üêæüê£ü¶Öüê§üïäÔ∏èüêßüê•üê¶ü¶Üü¶âü¶¢ü¶öü¶úüê∏üêäüê¢ü¶éüêçüê≤üêâü¶ïü¶ñüê≥üêãüê¨üêüüê†üê°ü¶àüêåüêôü¶ëüêöü¶êü¶Äü¶ûü¶ãüêõüêúüêùüêûü¶óüï∑Ô∏èüíÆüï∏Ô∏èüå∏ü¶Çüíêü¶†ü¶üüèµÔ∏èüå∑üåπüåºüåªü•Äüå∫üå±üåøüå≤üåæüåµüå≥üå¥üçÉüçÅüçÇüçÄ‚òòÔ∏èüìªüîáüîàüîâüîäüì¢üì£üìØüîîüîïüéºüéµüé∂üéôÔ∏èüéöÔ∏èüéõÔ∏èüé§üéßüé∑üé∏üéπüé∫üéªü•Åüì±üì≤‚òéÔ∏èüìûüìüüñ®Ô∏èüì†üñ•Ô∏èüíªüîãüîåüñ±Ô∏èüñ≤Ô∏è‚å®Ô∏èüíΩüíæüíøüìÄüßÆüì∑üì∫üé•üé¨üìΩÔ∏èüéûÔ∏èüîçüì∏üîéüìπüïØÔ∏èüí°üî¶üèÆüìîüìïüìñüìóüìòüìôüìÑüìöüìúüìÉüììüìíüí¥üì∞üí∞üóûÔ∏èüè∑Ô∏èüìëüîñüí∏üí∂üíµüí∑üí≥üßæüíπüí±üì§üí≤üì©üì®‚úâÔ∏èüìßüì¶üì´üì•üì™üì¨üì≠üìÆüñçÔ∏èüó≥Ô∏èüñåÔ∏è‚úèÔ∏èüñäÔ∏è‚úíÔ∏èüñãÔ∏èüìùüìÜüíºüìÖüóÇÔ∏èüìÅüìÇüóìÔ∏èüìáüóíÔ∏èüìàüìâüìäüìã‚úÇÔ∏èüìåüìêüìçüìèüìéüñáÔ∏èüóëÔ∏èüîíüóÑÔ∏èüîìüóÉÔ∏èüîèüîêüó°Ô∏èüîëüõ†Ô∏èüóùÔ∏è‚öíÔ∏èüî®‚õèÔ∏èüî´üèπ‚öîÔ∏èüõ°Ô∏èüîßüî©‚öôÔ∏è‚öóÔ∏èüóúÔ∏èüß≤‚öñÔ∏èüß∞üîó‚õìÔ∏èüß´üß¨üß™üî¨üî≠üì°üíâüõÅüíäüöøüö™üöΩüõãÔ∏èüõèÔ∏èüß∫üßπüßªüß∑üß¥üßºüßΩüèßüßØüóøüõí‚ö±Ô∏èüö¨‚ö∞Ô∏èüîûüöØüìµüö≠‚õîüö≥‚ò¢Ô∏èüö´‚ò£Ô∏èüöØüö∑üö±üö∏üöæ‚ö†Ô∏èüõÇüõÖüõÑüõÉ‚ÜòÔ∏è‚û°Ô∏è‚¨ÜÔ∏è‚ò¢Ô∏è‚ÜñÔ∏è‚§¥Ô∏èüõê‚§µÔ∏èüîõüõê‚òØÔ∏èüîùüîú‚úùÔ∏èüîØ‚ôâüïé‚ôäüïé‚ôã‚ò™Ô∏è‚úùÔ∏è‚òÆÔ∏èüïâÔ∏è‚öõÔ∏è‚ôì‚è©‚õé‚ñ∂Ô∏èüîÇüîÅ‚è≠Ô∏è‚èØÔ∏èüîΩüîº‚è∏Ô∏è‚èèÔ∏èüé¶‚è¨‚è∫Ô∏è‚èπÔ∏è‚èÆÔ∏è‚è™‚ôæÔ∏è‚öïÔ∏è‚ôÇÔ∏èüì∂üî±üì∂‚ôÇÔ∏èüì¥‚òëÔ∏è";

    if (!availableEmojis.includes(emojiInput)) {
        return api.sendMessage(`‚ùå Emoji "${emojiInput}" kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£ ho·∫∑c kh√¥ng h·ª£p l·ªá!`, threadID, messageID);
    }

    try {
        
        const emojiCode = emojiInput.codePointAt(0).toString(16).toLowerCase();

       
        const gifUrl = `https://fonts.gstatic.com/s/e/notoemoji/latest/${emojiCode}/512.gif`;

        
        const gifPath = path.join(__dirname, 'cache', 'emoji.gif');
        const response = await axios.get(gifUrl, { responseType: 'arraybuffer' });
        fs.writeFileSync(gifPath, Buffer.from(response.data));

        
        return api.sendMessage({ body: "‚ú® Emoji GIF:", attachment: fs.createReadStream(gifPath) }, threadID, messageID);
    } catch (error) {
        console.error(error);
        return api.sendMessage("‚ùå ƒê√£ x·∫£y ra l·ªói trong qu√° tr√¨nh chuy·ªÉn ƒë·ªïi emoji th√†nh GIF.", threadID, messageID);
    }
};
